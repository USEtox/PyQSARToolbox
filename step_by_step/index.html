
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python client for the local QSAR Toolbox Web API">
      
      
      
        <link rel="canonical" href="https://usetox.github.io/PyQSARToolbox/step_by_step/">
      
      
        <link rel="prev" href="../run_qsar/">
      
      
        <link rel="next" href="../workflows/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Step by Step - PyQSARToolbox</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-by-step-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PyQSARToolbox" class="md-header__button md-logo" aria-label="PyQSARToolbox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyQSARToolbox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Step by Step
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/USEtox/PyQSARToolbox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    USEtox/PyQSARToolbox
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyQSARToolbox" class="md-nav__button md-logo" aria-label="PyQSARToolbox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyQSARToolbox
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/USEtox/PyQSARToolbox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    USEtox/PyQSARToolbox
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../search_chemicals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search for Chemicals
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../extract_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Experimental Data
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../run_qsar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QSAR Models
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Step by Step
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Step by Step
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-statement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem statement
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problem statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-extract-chemid" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: extract ChemId
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-find-the-location-of-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: find the location of endpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-extracting-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: extracting data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-running-qsar-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: running QSAR models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-alternative-using-calculators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4 (alternative): using calculators
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-step" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next step
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-statement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem statement
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problem statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-extract-chemid" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: extract ChemId
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-find-the-location-of-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: find the location of endpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-extracting-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: extracting data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-running-qsar-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: running QSAR models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-alternative-using-calculators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4 (alternative): using calculators
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-step" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next step
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="step-by-step-guide">Step by step guide<a class="headerlink" href="#step-by-step-guide" title="Permanent link">&para;</a></h1>
<p>This page shows an example of the usage of <code>PyQSARToolbox</code> based on one of the author's projects.</p>
<h2 id="problem-statement">Problem statement<a class="headerlink" href="#problem-statement" title="Permanent link">&para;</a></h2>
<p>We have a list of compounds identified by their <code>CAS RN</code> and <code>SMILES</code>. We want to call all the available QSAR models for vapor pressure and also extract the available experimental data. </p>
<h3 id="step-1-extract-chemid">Step 1: extract <code>ChemId</code><a class="headerlink" href="#step-1-extract-chemid" title="Permanent link">&para;</a></h3>
<p>First, we look for the <code>ChemId</code> for all the compounds, first by searching with <code>CAS RN</code>, followed by <code>SMILES</code> and potentially <code>names</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># water solubility of 50-03-3</span>
<span class="n">chem_by_cas</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">search_CAS</span><span class="p">(</span><span class="s2">&quot;50-03-3&quot;</span><span class="p">)</span>
<span class="n">chem_id</span> <span class="o">=</span> <span class="n">chem_by_cas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;ChemId&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="step-2-find-the-location-of-endpoint">Step 2: find the location of endpoint<a class="headerlink" href="#step-2-find-the-location-of-endpoint" title="Permanent link">&para;</a></h3>
<p>We get the <code>endpoint tree</code> and look for the desired endpoint in it. The goal is to extract the positions in the tree that seem to be relevant to our desired endpoint properties.</p>
<blockquote>
<p>WARNING: you can find irrelevant values too, depending on the keywords used to search for the endpoints.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">endpoints_tree</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">get_endpoints_tree</span><span class="p">()</span>
<span class="n">water_solubility_position</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">endpoints_tree</span> <span class="k">if</span> <span class="s2">&quot;water solubility&quot;</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
<h3 id="step-3-extracting-data">Step 3: extracting data<a class="headerlink" href="#step-3-extracting-data" title="Permanent link">&para;</a></h3>
<p>After finding the position of the desired endpoint in the tree, we use it to find the available data and models for it. First, we have to get the available endpoint for the selected position in the endpoints tree by calling the method <code>get_endpoints_from_tree</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">available_water_solubility_endpoints</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">get_endpoints_from_tree</span><span class="p">(</span>
    <span class="n">water_solubility_position</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available endpoints:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">endpoint</span> <span class="ow">in</span> <span class="n">available_water_solubility_endpoints</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - &quot;</span> <span class="o">+</span> <span class="n">endpoint</span><span class="p">)</span>
</code></pre></div>
<p>As you can see, the first entry does not match what we are looking for (which is the solubility of organic compounds). Therefore, we will only use the last two elements (note the small and capital <code>W</code> in water. It becomes important because each one refers to a different dataset!) Here's how we can search for data using the method <code>get_endpoint_data</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">water_solubility_values</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">qs</span><span class="o">.</span><span class="n">get_endpoint_data</span><span class="p">(</span>
        <span class="n">chem_id</span><span class="o">=</span><span class="n">chem_id</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="n">water_solubility_position</span><span class="p">,</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">available_water_solubility_endpoints</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="c1"># print each end point dict in the list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">water_solubility_values</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">water_solubility_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div>
<h3 id="step-4-running-qsar-models">Step 4: running QSAR models<a class="headerlink" href="#step-4-running-qsar-models" title="Permanent link">&para;</a></h3>
<p>The above results are identical for both <code>water solubility</code> entries with small and capital <code>W</code>. Now, we can find the <code>QSAR</code> models for the same endpoints. It is done by calling the method <code>get_qsar_models</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># run QSAR model for water solubility</span>
<span class="n">ws_qsar_models</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">get_qsar_models</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">water_solubility_position</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available QSAR models:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">ws_qsar_models</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div>
<p>We can see that four models are available for predicting water solubility: two models from EPI Suite, and one model each for VEGA and OPERA. We can run the models now:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># run the models and time each one</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ws_QSAR_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">ws_qsar_models</span><span class="p">:</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">apply_qsar_chemical</span><span class="p">(</span><span class="n">chem_id</span><span class="p">,</span> <span class="n">qsar_model_guid</span><span class="o">=</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;Guid&quot;</span><span class="p">])</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ws_QSAR</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">apply_qsar_chemical</span><span class="p">(</span><span class="n">chem_id</span><span class="p">,</span> <span class="n">qsar_model_guid</span><span class="o">=</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;Guid&quot;</span><span class="p">])</span>
    <span class="n">ws_QSAR</span><span class="p">[</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;Caption&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span>
    <span class="n">ws_QSAR</span><span class="p">[</span><span class="s2">&quot;Unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;Unit&quot;</span><span class="p">]</span>
    <span class="n">ws_QSAR_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ws_QSAR</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time elapsed for </span><span class="si">{</span><span class="n">model</span><span class="p">[</span><span class="s1">&#39;Caption&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</code></pre></div>
<p>On my system, I obtained the following run times (note the longer runtime of OPERA):  </p>
<div class="highlight"><pre><span></span><code>Time elapsed for Water Solubility (EPISUITE): 0.06 seconds
Time elapsed for VEGA - Water solubility model (IRFMN): 7.29 seconds
Time elapsed for Water Solubility (fragments) (EPISUITE): 0.03 seconds
Time elapsed for OPERA WS: 28.05 seconds
</code></pre></div>
<p>You can also dump the results as <code>JSON</code> for a higher readability:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># print the results</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div>
<h3 id="step-4-alternative-using-calculators">Step 4 (alternative): using calculators<a class="headerlink" href="#step-4-alternative-using-calculators" title="Permanent link">&para;</a></h3>
<p>Another way of calling <code>QSAR</code> model in QSAR Toolbox is using <code>calculators</code>. First, we need to get the list of the available calculators:</p>
<div class="highlight"><pre><span></span><code><span class="n">calculators_list</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">get_available_calculators</span><span class="p">()</span>
<span class="n">calculators_list</span>
</code></pre></div>
<p>There are too many of these calculators. We can look for the right one by looking into the 'Caption' or 'Description' of each element. For instance, we can look for 'water solubility':</p>
<div class="highlight"><pre><span></span><code><span class="n">WS_calculators</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">calculators_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="s2">&quot;water solubility&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;Caption&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">WS_calculators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WS_calculators</span><span class="p">)</span>
</code></pre></div>
<p>Note that these calculators are only available for the "native" QSAR Toolbox methods and data. The addons (e.g. VEGA and OPERA) are either not part of the calculators or possibly I could not find them. Now, we can call the calculators using the method <code>run_calculator</code> for a specified chemical.</p>
<div class="highlight"><pre><span></span><code><span class="n">WS_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">WS_calculators</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">run_calculator</span><span class="p">(</span><span class="n">calculation_guid</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;Guid&quot;</span><span class="p">],</span> <span class="n">chem_id</span><span class="o">=</span><span class="n">chem_id</span><span class="p">)</span>
    <span class="n">WS_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WS_values</span><span class="p">)</span>
</code></pre></div>
<p>The advantage of using <code>calculators</code> over the alternative methods is that it is simpler to set up and also faster computationally (based on my limited tests).</p>
<h2 id="next-step">Next step<a class="headerlink" href="#next-step" title="Permanent link">&para;</a></h2>
<p>Have a look at the <a href="../workflows/">QSAR Toolbox <code>workflows</code></a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.instant", "content.code.copy"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>